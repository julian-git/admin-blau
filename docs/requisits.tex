\documentclass[10pt]{amsart}

\usepackage{a4wide}
\usepackage[usenames,dvipsnames]{color}
\usepackage[latin1]{inputenc}
\usepackage[catalan]{babel}
\usepackage{paralist}
\usepackage{graphicx}
\usepackage{times}

\newcommand{\obert}{\textcolor{red}{\bfseries Obert\ }}
\newcommand{\falta}{\textcolor{red}{\bfseries Falta\ }}
\newcommand{\progres}{\textcolor{BurntOrange}{\bfseries En progrès\ }}
\newcommand{\complert}{\textcolor{ForestGreen}{\bfseries Complert\ }}

\newcommand{\uri}[1]{\textcolor{Plum}{#1}}
\newcommand{\guillem}[1]{\textcolor{MidnightBlue}{#1}}
\newcommand{\julian}[1]{\textcolor{YellowOrange}{#1}}

\begin{document}

\title{l'Admin Blau: Requisits}
\maketitle

\uri{Color dels comentaris d'en Uri.}

\guillem{Color dels comentaris d'en Guillem.}

\julian{Color dels comentaris d'en Julian.}


\section{Descripció de les entitats principals de l'aplicació}

\begin{description}
\item[Castellers] \complert
\item[Categories de castellers] \complert
\item[Rols] \complert; sense funcionalitat
\item[Famílies] \progres definit, crud funciona; \falta taula intermitjana per persones
\item[Quotes]\progres crud parcial; \falta poder editar bé els responsables i coberts 
\item[Esdeveniments] \progres \falta preus
\item[Compte] \falta
\item[Rebuts] \falta
\end{description}


\section{Requisits funcionals}

\subsection{Versió 0.5}
\begin{description}
\setlength{\itemsep}{3ex}
\item[R01] \progres Alta, baixa i modificació de persones 

\begin{itemize}
\item \complert Un administrador ha de poder accedir a una part privada per afegir, editar i eliminar persones a la base de dades. 
\item \falta Quan es doni d'alta una persona, enviar-li un mail informant-lo de l'alta i se li adjunten les dades per a que les comprovi. 
\item \falta Quan es doni de baixa algú, enviar també mail informant. 
\item \falta S'ha de preguntar cada vegada a l'administrador si enviar o no aquests mails.
\end{itemize}

\item[R02] \progres Agrupar persones per famílies 

Les famílies estaran composades per diversos castellers ja existents a la base de persones.
Cada persona només pot pertànyer a una família.

\begin{itemize}
\item \progres  L'administrador ha de poder afegir, editar i eliminar famílies. \falta el rol
\item \falta Quan es doni d'alta una família, avisar a tots els responsables de que se'ls ha agrupat en una família per mail. 
\item \falta El mateix quan es doni de baixa. 
\item \falta S'ha de preguntar cada vegada a l'administrador si enviar o no aquests mails.
\end{itemize}


\item[R03] \progres Alta, baixa i modificació de quotes 

\begin{itemize}
\item \complert L'administrador ha de poder afegir, editar i eliminar quotes.
\item \complert Una quota té un responsable (a la taula de persones), que és el titular del compte corrent al que es passa el rebut. 
\item \complert Cada quota tindrà associat un llistat de un o més castellers als quals ``cobreix''. 
\item \falta Cada vegada que es dóna d'alta/baixa una quota, enviar un mail al responsable informant-lo.
\item \falta S'ha de preguntar cada vegada a l'administrador si enviar o no aquests mails.
\end{itemize}

\item[R04] Generació de rebuts 

  \begin{itemize}
  \item\falta L'administrador ha de poder generar rebuts per a les quotes de manera periòdica.
\item\falta Cada vegada que es generi un rebut, se seleccionaràn les quotes sobre les que es genera el rebut, es crearà un fitxer de text pla seguint el format N19 (\guillem{cal mirar el format, crec que amb els IBAN canvia!}) per a descarregar (i després pujar-lo al banc) i es guardarà un històric de cada rebut passat a cada responsable de quota.
\item\falta Guardar el fitxer de text generat.

\item\falta Enviar un mail als responsables de la quota de que es passa la quota. Hi ha gent que es queixa de que no s'avisa quan es passen les quotes, d'aquesta manera se'ls avisaria de manera automàtica.

\item\falta S'ha de poder generar un rebut de manera manual i sense que produeixi un fitxer de text. Això servirà per a re-cobrar els rebuts tornats en efectiu i mantenir un històric del que tornem.
  \end{itemize}
  
  \item[R05] Consulta de quotes 
  \begin{itemize}
\item\falta L'administrador ha de poder treure un llistat de totes les quotes actives i al corrent de pagament (\falta\guillem{hem de pensar com determinar si una quota està al corrent del pagament o no})
\end{itemize}

\end{description}

\subsection{Tarees per completar la versió 0.5}

\begin{itemize}
\item \complert Completar la taula Families i les seves taules auxiliars
\item Decidir un gestor de rols 
\end{itemize}

\subsection{Versió 1.0}

\begin{description}
\setlength{\itemsep}{3ex}
\item[R05] \falta Consulta i modificació de l'històric de rebuts 

L'administrador ha de poder consultar els rebuts passats i el seu estat. També ha de poder canviar l'estat, per marcar els rebuts retornats.

Quan un rebut es marqui com a retornat, enviar un mail al responsable de la quota per a informar-lo.

\item[R06] \complert Crear, editar i esborrar esdeveniments 

L'administrador ha de poder crear, modificar i esborrar esdeveniments.

\item[R07] \progres Modificació de les dades "personals" per part d'una persona  \falta rols

\item[R08] \progres Modificació de les dades "personals" d'una família per part d'un responsable 
\falta rols

\item[R09] \falta Cada mes s'ha de poder treure una llista de quotes per passar al banc 

\item[R10] \complert Una persona ha de poder pagar la quota per a una altra persona o persones 

\item[R11] \complert Hi ha persones que no volen rebre els SMS de la colla

\item[R12] \complert Volem un llistat d'apuntats a una activitat 

\item[R13] \falta Volem un llistat d'assistents a una activitat?? \guillem{diria que mai es passa llista, no crec que calgui.}

\item[R14] \complert Les quotes poden tenir una periodicitat diferent i un import diferent per cada casteller. 

\begin{itemize}
\item \complert Les periodicitats es definiran en mesos, i estaran predefinides en el sistema (trimestral o anual).  

\item \complert S'han de poder afegir noves periodicitats en un futur (encara que sigui directament a la BD) 
\end{itemize}

\end{description}

\section{Discussió de taules individuals}

\subsection{Famílies}

Les unitats familiars seran agrupacions de castellers.


Cal tenir en compte que hi ha famílies que són només de canalla. 
Per tant, cal contemplar la manera de poder afegir informació d'algun contacte dels pares (que no tenen perquè ser castellers). 
També cal tenir en compte que hi ha famílies on els pares estàn separats i tots 2 volen rebre tota la informació de les activitats dels fills.

\subsubsection*{Camps}
\begin{itemize}
\item id
\item nom (els cognoms?)
\item activa
\item\ [id dels castellers de la família] (FK)
\item\ [ids dels castellers responsables] (FK)   afegir boolea de responsable/no responsable a la taula auxiliar
\end{itemize}

\subsection{Rebuts}

Cada vegada que generem un moviment econòmic, cal guardar l'històric.
Això ens pot permetre treure estadístiques de quotes, veure quant ha pagat/gastat cadascú en un període.
Els rebuts seran o bé de quotes o bé d'esdeveniments o bé de compte.
L'import pot ser negatiu (una pagament de quota, d'activitat o de birra) o positiu (aportació al compte). 
Això ho podem canviar!

Camps
\begin{itemize}
\item id
\item id\_casteller (FK)
\item import
\item mètode de pagament (efectiu, rebut, ?)
\item estat (pagat, retornat, pendent, ?)
\item data
\item id\_quota (FK)
\end{itemize}


\begin{figure}[htbp]
  \centering
  \includegraphics[width=\linewidth]{DbSchemaAdminBlau_persones_quotes_families}
  
\caption{Les taules per persones, quotes i families. \textbf{Potser que no sigui actualitzat}}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=\linewidth]{DbSchemaAdminBlau}
  
\caption{Totes les taules de la db, actualitzats}
\end{figure}
\end{document}
